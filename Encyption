ðŸ”¹ Layer 1 â€” Create passphrase-protected CA key

Generate CA key (RSA 4096-bit)

# ssh-keygen -t rsa -b 4096 -f /mnt/secure/ssh_ca -C "SSH CA key"

It will ask: "Enter passphrase"
This encrypts the private key file with OpenSSH's format

	â€¢	The /mnt/secure directory will be our LUKS mount point later.

================================================

ðŸ”¹ Layer 2 â€” Store in LUKS-encrypted filesystem

1. Create a new encrypted volume

Replace /dev/sdb1 with the partition you want to use
# cryptsetup luksFormat /dev/sdb1

It will warn and then ask for a LUKS passphrase (different from CA key passphrase).

2. Open and mount the encrypted volume

# cryptsetup luksOpen /dev/sdb1 secure_volume
# mkfs.ext4 /dev/mapper/secure_volume
# mkdir /mnt/secure
# mount /dev/mapper/secure_volume /mnt/secure

Now /mnt/secure is a LUKS-protected filesystem.

3. Move CA key inside

# mv ssh_ca ssh_ca.pub /mnt/secure/
# chmod 600 /mnt/secure/ssh_ca

	â€¢	The CA key is now inside the encrypted volume.
	â€¢	When the system is off, itâ€™s completely unreadable.

================================================

ðŸ”¹ Layer 3 â€” GPG-encrypted backup

Symmetric encryption (password-based)
# gpg -c /mnt/secure/ssh_ca
  â€¢ Creates ssh_ca.gpg (encrypted backup)

Or use asymmetric encryption (public key)
# gpg --encrypt --recipient yourname@example.com /mnt/secure/ssh_ca

	â€¢	Store ssh_ca.gpg offsite (USB drive, secure cloud storage).
	â€¢	If you use asymmetric encryption, only your private GPG key can decrypt it.

================================================

âœ… Recovery flow
	1.	Unlock LUKS:

# cryptsetup luksOpen /dev/sdb1 secure_volume
# mount /dev/mapper/secure_volume /mnt/secure

	2.	Use CA key (will prompt for CA key passphrase when signing):

# ssh-keygen -s /mnt/secure/ssh_ca -I user01 -n username -V +52w user01.pub

	3.	Unmount and lock:

# umount /mnt/secure
# cryptsetup luksClose secure_volume

================================================

With this setup:
	â€¢	An attacker must physically access the disk,
	â€¢	Unlock LUKS,
	â€¢	Steal the CA key,
	â€¢	Break its passphrase,
	â€¢	And possibly decrypt the GPG backup â€” a very unlikely chain.